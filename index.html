<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GenQR & QR Tools - Herramientas Online Gratuitas</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background: #0f172a;
            overflow-x: hidden;
        }

        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .glass-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .tool-icon {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: transform 0.3s ease;
        }

        .glass-card:hover .tool-icon {
            transform: scale(1.1) rotate(5deg);
        }

        .drop-zone {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        .drop-zone.dragover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .loading-spinner {
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .progress-bar {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s ease;
        }

        .bg-grid {
            background-image:
                linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 50px 50px;
        }

        .floating {
            animation: floating 6s ease-in-out infinite;
        }

        @keyframes floating {

            0%,
            100% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-20px);
            }
        }

        .tool-section {
            display: none;
        }

        .tool-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .file-item {
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }

            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
    </style>
    <base target="_blank">
</head>

<body class="text-white min-h-screen bg-grid">

    <!-- Navigation -->
    <nav class="fixed w-full z-50 bg-slate-900/80 backdrop-blur-md border-b border-white/10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center cursor-pointer" onclick="showHome()">
                    <div
                        class="w-10 h-10 rounded-xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center mr-3">
                        <i data-lucide="file-text" class="w-6 h-6 text-white"></i>
                    </div>
                    <span class="text-xl font-bold gradient-text">GenQR</span>
                </div>
                <div class="hidden md:flex space-x-8">
                    <button onclick="showHome()" class="hover:text-purple-400 transition">Inicio</button>
                    <button onclick="showTool('qr')" class="hover:text-purple-400 transition">Generador QR</button>
                    <button onclick="showTool('merge')" class="hover:text-purple-400 transition">Unir PDF</button>
                    <button onclick="showTool('split')" class="hover:text-purple-400 transition">Dividir PDF</button>
                    <button onclick="showTool('compress')" class="hover:text-purple-400 transition">Comprimir</button>
                    <button onclick="showTool('convert')" class="hover:text-purple-400 transition">Convertir</button>
                </div>
                <button class="md:hidden" onclick="toggleMobileMenu()">
                    <i data-lucide="menu" class="w-6 h-6"></i>
                </button>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobileMenu" class="hidden md:hidden bg-slate-900 border-t border-white/10">
            <div class="px-4 pt-2 pb-4 space-y-2">
                <button onclick="showHome()" class="block w-full text-left py-2 hover:text-purple-400">Inicio</button>
                <button onclick="showTool('qr')" class="block w-full text-left py-2 hover:text-purple-400">Generador
                    QR</button>
                <button onclick="showTool('merge')" class="block w-full text-left py-2 hover:text-purple-400">Unir
                    PDF</button>
                <button onclick="showTool('split')" class="block w-full text-left py-2 hover:text-purple-400">Dividir
                    PDF</button>
                <button onclick="showTool('compress')"
                    class="block w-full text-left py-2 hover:text-purple-400">Comprimir</button>
                <button onclick="showTool('convert')"
                    class="block w-full text-left py-2 hover:text-purple-400">Convertir</button>
            </div>
        </div>
    </nav>

    <!-- Home Section -->
    <section id="home" class="tool-section active pt-24 pb-12 px-4">
        <!-- Hero -->
        <div class="max-w-7xl mx-auto text-center mb-16">
            <div class="floating inline-block mb-6">
                <div
                    class="w-24 h-24 mx-auto rounded-3xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center shadow-2xl shadow-purple-500/30">
                    <i data-lucide="sparkles" class="w-12 h-12 text-white"></i>
                </div>
            </div>
            <h1 class="text-5xl md:text-7xl font-bold mb-6 leading-tight">
                Herramientas <span class="gradient-text">PDF & QR</span><br>
                Online Gratuitas
            </h1>
            <p class="text-xl text-gray-400 max-w-2xl mx-auto mb-8">
                Edita, convierte y gestiona tus documentos PDF y genera códigos QR de forma segura y gratuita.
                Todo el procesamiento se realiza en tu navegador.
            </p>
            <div class="flex flex-wrap justify-center gap-4">
                <button onclick="showTool('qr')"
                    class="btn-primary px-8 py-4 rounded-full font-semibold text-lg flex items-center gap-2">
                    <i data-lucide="qr-code" class="w-5 h-5"></i>
                    Generar QR
                </button>
                <button onclick="showTool('merge')"
                    class="px-8 py-4 rounded-full font-semibold text-lg border border-white/20 hover:bg-white/5 transition flex items-center gap-2">
                    <i data-lucide="files" class="w-5 h-5"></i>
                    Unir PDFs
                </button>
            </div>
        </div>

        <!-- Tools Grid -->
        <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 px-4">

            <!-- QR Generator -->
            <div onclick="showTool('qr')" class="glass-card rounded-2xl p-6 cursor-pointer group">
                <div class="tool-icon w-14 h-14 rounded-xl flex items-center justify-center mb-4">
                    <i data-lucide="qr-code" class="w-7 h-7 text-white"></i>
                </div>
                <h3 class="text-xl font-bold mb-2">Generador QR</h3>
                <p class="text-gray-400 text-sm">Crea códigos QR personalizados para URLs, texto, contactos y más.</p>
            </div>

            <!-- Merge PDF -->
            <div onclick="showTool('merge')" class="glass-card rounded-2xl p-6 cursor-pointer group">
                <div class="tool-icon w-14 h-14 rounded-xl flex items-center justify-center mb-4">
                    <i data-lucide="combine" class="w-7 h-7 text-white"></i>
                </div>
                <h3 class="text-xl font-bold mb-2">Unir PDF</h3>
                <p class="text-gray-400 text-sm">Combina múltiples archivos PDF en un solo documento ordenado.</p>
            </div>

            <!-- Split PDF -->
            <div onclick="showTool('split')" class="glass-card rounded-2xl p-6 cursor-pointer group">
                <div class="tool-icon w-14 h-14 rounded-xl flex items-center justify-center mb-4">
                    <i data-lucide="scissors" class="w-7 h-7 text-white"></i>
                </div>
                <h3 class="text-xl font-bold mb-2">Dividir PDF</h3>
                <p class="text-gray-400 text-sm">Separa un PDF en múltiples archivos o extrae páginas específicas.</p>
            </div>

            <!-- Compress PDF -->
            <div onclick="showTool('compress')" class="glass-card rounded-2xl p-6 cursor-pointer group">
                <div class="tool-icon w-14 h-14 rounded-xl flex items-center justify-center mb-4">
                    <i data-lucide="minimize-2" class="w-7 h-7 text-white"></i>
                </div>
                <h3 class="text-xl font-bold mb-2">Comprimir PDF</h3>
                <p class="text-gray-400 text-sm">Reduce el tamaño de tus PDFs manteniendo la calidad óptima.</p>
            </div>

            <!-- Office to PDF -->
            <div onclick="showTool('office')" class="glass-card rounded-2xl p-6 cursor-pointer group">
                <div class="tool-icon w-14 h-14 rounded-xl flex items-center justify-center mb-4">
                    <i data-lucide="file-input" class="w-7 h-7 text-white"></i>
                </div>
                <h3 class="text-xl font-bold mb-2">Office a PDF</h3>
                <p class="text-gray-400 text-sm">Convierte Word, Excel y PowerPoint a PDF fácilmente.</p>
            </div>

            <!-- PDF to Images -->
            <div onclick="showTool('pdf2img')" class="glass-card rounded-2xl p-6 cursor-pointer group">
                <div class="tool-icon w-14 h-14 rounded-xl flex items-center justify-center mb-4">
                    <i data-lucide="image" class="w-7 h-7 text-white"></i>
                </div>
                <h3 class="text-xl font-bold mb-2">PDF a Imágenes</h3>
                <p class="text-gray-400 text-sm">Convierte cada página de tu PDF a formato JPG o PNG.</p>
            </div>

            <!-- Images to PDF -->
            <div onclick="showTool('img2pdf')" class="glass-card rounded-2xl p-6 cursor-pointer group">
                <div class="tool-icon w-14 h-14 rounded-xl flex items-center justify-center mb-4">
                    <i data-lucide="file-image" class="w-7 h-7 text-white"></i>
                </div>
                <h3 class="text-xl font-bold mb-2">Imágenes a PDF</h3>
                <p class="text-gray-400 text-sm">Convierte JPG y PNG a un archivo PDF organizado.</p>
            </div>

            <!-- PDF to Word -->
            <div onclick="showTool('pdf2word')" class="glass-card rounded-2xl p-6 cursor-pointer group">
                <div class="tool-icon w-14 h-14 rounded-xl flex items-center justify-center mb-4">
                    <i data-lucide="file-type-2" class="w-7 h-7 text-white"></i>
                </div>
                <h3 class="text-xl font-bold mb-2">PDF a Word</h3>
                <p class="text-gray-400 text-sm">Extrae texto e imágenes de PDF a documento Word editable.</p>
            </div>

            <!-- Protect PDF -->
            <div onclick="showTool('protect')" class="glass-card rounded-2xl p-6 cursor-pointer group">
                <div class="tool-icon w-14 h-14 rounded-xl flex items-center justify-center mb-4">
                    <i data-lucide="shield" class="w-7 h-7 text-white"></i>
                </div>
                <h3 class="text-xl font-bold mb-2">Proteger PDF</h3>
                <p class="text-gray-400 text-sm">Añade contraseña y encriptación a tus documentos PDF.</p>
            </div>
        </div>
    </section>

    <!-- QR Generator Tool -->
    <section id="tool-qr" class="tool-section pt-24 pb-12 px-4">
        <div class="max-w-4xl mx-auto">
            <button onclick="showHome()" class="mb-6 flex items-center text-gray-400 hover:text-white transition">
                <i data-lucide="arrow-left" class="w-5 h-5 mr-2"></i>
                Volver al inicio
            </button>

            <div class="glass-card rounded-3xl p-8 md:p-12">
                <div class="text-center mb-8">
                    <div
                        class="w-16 h-16 mx-auto rounded-2xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center mb-4">
                        <i data-lucide="qr-code" class="w-8 h-8 text-white"></i>
                    </div>
                    <h2 class="text-3xl font-bold mb-2">Generador de Códigos QR</h2>
                    <p class="text-gray-400">Crea códigos QR personalizados para cualquier contenido</p>
                </div>

                <div class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium mb-2">Contenido del QR</label>
                        <textarea id="qrText" rows="3"
                            class="w-full bg-slate-800/50 border border-white/10 rounded-xl px-4 py-3 focus:outline-none focus:border-purple-500 transition"
                            placeholder="Introduce texto, URL, o cualquier contenido..."></textarea>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Tamaño (px)</label>
                            <input type="number" id="qrSize" value="256" min="100" max="1000"
                                class="w-full bg-slate-800/50 border border-white/10 rounded-xl px-4 py-3 focus:outline-none focus:border-purple-500 transition">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Color</label>
                            <input type="color" id="qrColor" value="#000000"
                                class="w-full h-12 bg-slate-800/50 border border-white/10 rounded-xl px-2 cursor-pointer">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Color Fondo</label>
                            <input type="color" id="qrBgColor" value="#ffffff"
                                class="w-full h-12 bg-slate-800/50 border border-white/10 rounded-xl px-2 cursor-pointer">
                        </div>
                    </div>

                    <button onclick="generateQR()"
                        class="btn-primary w-full py-4 rounded-xl font-semibold text-lg flex items-center justify-center gap-2">
                        <i data-lucide="refresh-cw" class="w-5 h-5"></i>
                        Generar QR
                    </button>

                    <div id="qrResult" class="hidden text-center pt-6 border-t border-white/10">
                        <div id="qrcode" class="inline-block p-4 bg-white rounded-2xl mb-4"></div>
                        <div class="flex justify-center gap-4">
                            <button onclick="downloadQR()"
                                class="px-6 py-3 bg-slate-700 hover:bg-slate-600 rounded-xl font-medium transition flex items-center gap-2">
                                <i data-lucide="download" class="w-5 h-5"></i>
                                Descargar PNG
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Merge PDF Tool -->
    <section id="tool-merge" class="tool-section pt-24 pb-12 px-4">
        <div class="max-w-4xl mx-auto">
            <button onclick="showHome()" class="mb-6 flex items-center text-gray-400 hover:text-white transition">
                <i data-lucide="arrow-left" class="w-5 h-5 mr-2"></i>
                Volver al inicio
            </button>

            <div class="glass-card rounded-3xl p-8 md:p-12">
                <div class="text-center mb-8">
                    <div
                        class="w-16 h-16 mx-auto rounded-2xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center mb-4">
                        <i data-lucide="combine" class="w-8 h-8 text-white"></i>
                    </div>
                    <h2 class="text-3xl font-bold mb-2">Unir PDFs</h2>
                    <p class="text-gray-400">Combina múltiples archivos PDF en uno solo</p>
                </div>

                <div id="mergeDropZone" class="drop-zone rounded-2xl p-12 text-center cursor-pointer mb-6"
                    onclick="document.getElementById('mergeInput').click()">
                    <input type="file" id="mergeInput" multiple accept=".pdf" class="hidden"
                        onchange="handleMergeFiles(this.files)">
                    <i data-lucide="upload-cloud" class="w-16 h-16 mx-auto mb-4 text-gray-400"></i>
                    <p class="text-lg font-medium mb-2">Arrastra archivos PDF aquí</p>
                    <p class="text-sm text-gray-400">o haz clic para seleccionar archivos</p>
                </div>

                <div id="mergeFileList" class="space-y-2 mb-6 hidden">
                    <!-- Files will be listed here -->
                </div>

                <div class="flex gap-4">
                    <button onclick="clearMergeFiles()"
                        class="flex-1 py-3 border border-white/20 rounded-xl hover:bg-white/5 transition">
                        Limpiar
                    </button>
                    <button onclick="mergePDFs()" id="mergeBtn"
                        class="flex-1 btn-primary py-3 rounded-xl font-semibold opacity-50 cursor-not-allowed" disabled>
                        Unir PDFs
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Split PDF Tool -->
    <section id="tool-split" class="tool-section pt-24 pb-12 px-4">
        <div class="max-w-4xl mx-auto">
            <button onclick="showHome()" class="mb-6 flex items-center text-gray-400 hover:text-white transition">
                <i data-lucide="arrow-left" class="w-5 h-5 mr-2"></i>
                Volver al inicio
            </button>

            <div class="glass-card rounded-3xl p-8 md:p-12">
                <div class="text-center mb-8">
                    <div
                        class="w-16 h-16 mx-auto rounded-2xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center mb-4">
                        <i data-lucide="scissors" class="w-8 h-8 text-white"></i>
                    </div>
                    <h2 class="text-3xl font-bold mb-2">Dividir PDF</h2>
                    <p class="text-gray-400">Separa un PDF en múltiples archivos</p>
                </div>

                <div id="splitDropZone" class="drop-zone rounded-2xl p-12 text-center cursor-pointer mb-6"
                    onclick="document.getElementById('splitInput').click()">
                    <input type="file" id="splitInput" accept=".pdf" class="hidden"
                        onchange="handleSplitFile(this.files[0])">
                    <i data-lucide="file-up" class="w-16 h-16 mx-auto mb-4 text-gray-400"></i>
                    <p class="text-lg font-medium mb-2">Selecciona un archivo PDF</p>
                    <p class="text-sm text-gray-400">Se mostrará el número total de páginas</p>
                </div>

                <div id="splitOptions" class="hidden space-y-6">
                    <div class="bg-slate-800/50 rounded-xl p-6">
                        <p class="text-sm text-gray-400 mb-2">Total de páginas</p>
                        <p id="totalPages" class="text-3xl font-bold gradient-text">0</p>
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Rango de páginas (ej: 1-3, 5, 7-9)</label>
                        <input type="text" id="pageRange" placeholder="1-3, 5, 7-9"
                            class="w-full bg-slate-800/50 border border-white/10 rounded-xl px-4 py-3 focus:outline-none focus:border-purple-500 transition">
                        <p class="text-xs text-gray-400 mt-2">Deja en blanco para dividir todas las páginas
                            individualmente</p>
                    </div>

                    <button onclick="splitPDF()" class="btn-primary w-full py-4 rounded-xl font-semibold text-lg">
                        Dividir PDF
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Compress PDF Tool -->
    <section id="tool-compress" class="tool-section pt-24 pb-12 px-4">
        <div class="max-w-4xl mx-auto">
            <button onclick="showHome()" class="mb-6 flex items-center text-gray-400 hover:text-white transition">
                <i data-lucide="arrow-left" class="w-5 h-5 mr-2"></i>
                Volver al inicio
            </button>

            <div class="glass-card rounded-3xl p-8 md:p-12">
                <div class="text-center mb-8">
                    <div
                        class="w-16 h-16 mx-auto rounded-2xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center mb-4">
                        <i data-lucide="minimize-2" class="w-8 h-8 text-white"></i>
                    </div>
                    <h2 class="text-3xl font-bold mb-2">Comprimir PDF</h2>
                    <p class="text-gray-400">Reduce el tamaño de tu PDF manteniendo la calidad</p>
                </div>

                <div id="compressDropZone" class="drop-zone rounded-2xl p-12 text-center cursor-pointer mb-6"
                    onclick="document.getElementById('compressInput').click()">
                    <input type="file" id="compressInput" accept=".pdf" class="hidden"
                        onchange="handleCompressFile(this.files[0])">
                    <i data-lucide="file-minus" class="w-16 h-16 mx-auto mb-4 text-gray-400"></i>
                    <p class="text-lg font-medium mb-2">Selecciona un archivo PDF</p>
                    <p class="text-sm text-gray-400">Tamaño máximo recomendado: 50MB</p>
                </div>

                <div id="compressOptions" class="hidden space-y-6">
                    <div class="bg-slate-800/50 rounded-xl p-6 flex justify-between items-center">
                        <div>
                            <p class="text-sm text-gray-400">Tamaño original</p>
                            <p id="originalSize" class="text-xl font-bold">0 MB</p>
                        </div>
                        <i data-lucide="arrow-right" class="w-6 h-6 text-gray-400"></i>
                        <div class="text-right">
                            <p class="text-sm text-gray-400">Tamaño estimado</p>
                            <p id="estimatedSize" class="text-xl font-bold gradient-text">0 MB</p>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Nivel de compresión</label>
                        <input type="range" id="compressLevel" min="1" max="3" value="2"
                            class="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer">
                        <div class="flex justify-between text-xs text-gray-400 mt-2">
                            <span>Recomendado</span>
                            <span>Extremo</span>
                            <span>Máximo</span>
                        </div>
                    </div>

                    <button onclick="compressPDF()" class="btn-primary w-full py-4 rounded-xl font-semibold text-lg">
                        Comprimir PDF
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Office to PDF Tool -->
    <section id="tool-office" class="tool-section pt-24 pb-12 px-4">
        <div class="max-w-4xl mx-auto">
            <button onclick="showHome()" class="mb-6 flex items-center text-gray-400 hover:text-white transition">
                <i data-lucide="arrow-left" class="w-5 h-5 mr-2"></i>
                Volver al inicio
            </button>

            <div class="glass-card rounded-3xl p-8 md:p-12">
                <div class="text-center mb-8">
                    <div
                        class="w-16 h-16 mx-auto rounded-2xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center mb-4">
                        <i data-lucide="file-input" class="w-8 h-8 text-white"></i>
                    </div>
                    <h2 class="text-3xl font-bold mb-2">Office a PDF</h2>
                    <p class="text-gray-400">Convierte Word, Excel y PowerPoint a PDF</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div class="bg-blue-500/20 border border-blue-500/30 rounded-xl p-6 text-center cursor-pointer hover:bg-blue-500/30 transition"
                        onclick="document.getElementById('officeInput').click()">
                        <i data-lucide="file-text" class="w-10 h-10 mx-auto mb-2 text-blue-400"></i>
                        <p class="font-medium">Word</p>
                        <p class="text-xs text-gray-400">.doc, .docx</p>
                    </div>
                    <div class="bg-green-500/20 border border-green-500/30 rounded-xl p-6 text-center cursor-pointer hover:bg-green-500/30 transition"
                        onclick="document.getElementById('officeInput').click()">
                        <i data-lucide="table" class="w-10 h-10 mx-auto mb-2 text-green-400"></i>
                        <p class="font-medium">Excel</p>
                        <p class="text-xs text-gray-400">.xls, .xlsx</p>
                    </div>
                    <div class="bg-orange-500/20 border border-orange-500/30 rounded-xl p-6 text-center cursor-pointer hover:bg-orange-500/30 transition"
                        onclick="document.getElementById('officeInput').click()">
                        <i data-lucide="presentation" class="w-10 h-10 mx-auto mb-2 text-orange-400"></i>
                        <p class="font-medium">PowerPoint</p>
                        <p class="text-xs text-gray-400">.ppt, .pptx</p>
                    </div>
                </div>

                <input type="file" id="officeInput" accept=".doc,.docx,.xls,.xlsx,.ppt,.pptx" class="hidden"
                    onchange="handleOfficeFile(this.files[0])">

                <div id="officePreview" class="hidden space-y-6">
                    <div class="bg-slate-800/50 rounded-xl p-6 flex items-center gap-4">
                        <div
                            class="w-12 h-12 rounded-lg bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center">
                            <i data-lucide="file" class="w-6 h-6"></i>
                        </div>
                        <div class="flex-1">
                            <p id="officeFileName" class="font-medium truncate"></p>
                            <p id="officeFileSize" class="text-sm text-gray-400"></p>
                        </div>
                    </div>

                    <div class="bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-4 flex items-start gap-3">
                        <i data-lucide="alert-triangle" class="w-5 h-5 text-yellow-400 flex-shrink-0 mt-0.5"></i>
                        <p class="text-sm text-gray-300">
                            Nota: Para archivos Office modernos (.docx, .xlsx, .pptx), se intentará extraer el
                            contenido.
                            Para mejores resultados, considera usar Microsoft Office o LibreOffice para la conversión
                            local.
                        </p>
                    </div>

                    <button onclick="convertOfficeToPDF()"
                        class="btn-primary w-full py-4 rounded-xl font-semibold text-lg">
                        Convertir a PDF
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- PDF to Images Tool -->
    <section id="tool-pdf2img" class="tool-section pt-24 pb-12 px-4">
        <div class="max-w-4xl mx-auto">
            <button onclick="showHome()" class="mb-6 flex items-center text-gray-400 hover:text-white transition">
                <i data-lucide="arrow-left" class="w-5 h-5 mr-2"></i>
                Volver al inicio
            </button>

            <div class="glass-card rounded-3xl p-8 md:p-12">
                <div class="text-center mb-8">
                    <div
                        class="w-16 h-16 mx-auto rounded-2xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center mb-4">
                        <i data-lucide="image" class="w-8 h-8 text-white"></i>
                    </div>
                    <h2 class="text-3xl font-bold mb-2">PDF a Imágenes</h2>
                    <p class="text-gray-400">Convierte cada página de tu PDF a JPG o PNG</p>
                </div>

                <div id="pdf2imgDropZone" class="drop-zone rounded-2xl p-12 text-center cursor-pointer mb-6"
                    onclick="document.getElementById('pdf2imgInput').click()">
                    <input type="file" id="pdf2imgInput" accept=".pdf" class="hidden"
                        onchange="handlePdf2ImgFile(this.files[0])">
                    <i data-lucide="images" class="w-16 h-16 mx-auto mb-4 text-gray-400"></i>
                    <p class="text-lg font-medium mb-2">Selecciona un archivo PDF</p>
                </div>

                <div id="pdf2imgOptions" class="hidden space-y-6">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Formato</label>
                            <select id="imgFormat"
                                class="w-full bg-slate-800/50 border border-white/10 rounded-xl px-4 py-3 focus:outline-none focus:border-purple-500 transition">
                                <option value="jpg">JPG</option>
                                <option value="png">PNG</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Calidad (DPI)</label>
                            <select id="imgQuality"
                                class="w-full bg-slate-800/50 border border-white/10 rounded-xl px-4 py-3 focus:outline-none focus:border-purple-500 transition">
                                <option value="150">150 DPI (Web)</option>
                                <option value="300" selected>300 DPI (Estándar)</option>
                                <option value="600">600 DPI (Alta)</option>
                            </select>
                        </div>
                    </div>

                    <button onclick="convertPdfToImages()"
                        class="btn-primary w-full py-4 rounded-xl font-semibold text-lg">
                        Convertir a Imágenes
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Images to PDF Tool -->
    <section id="tool-img2pdf" class="tool-section pt-24 pb-12 px-4">
        <div class="max-w-4xl mx-auto">
            <button onclick="showHome()" class="mb-6 flex items-center text-gray-400 hover:text-white transition">
                <i data-lucide="arrow-left" class="w-5 h-5 mr-2"></i>
                Volver al inicio
            </button>

            <div class="glass-card rounded-3xl p-8 md:p-12">
                <div class="text-center mb-8">
                    <div
                        class="w-16 h-16 mx-auto rounded-2xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center mb-4">
                        <i data-lucide="file-image" class="w-8 h-8 text-white"></i>
                    </div>
                    <h2 class="text-3xl font-bold mb-2">Imágenes a PDF</h2>
                    <p class="text-gray-400">Convierte JPG y PNG a un archivo PDF</p>
                </div>

                <div id="img2pdfDropZone" class="drop-zone rounded-2xl p-12 text-center cursor-pointer mb-6"
                    onclick="document.getElementById('img2pdfInput').click()">
                    <input type="file" id="img2pdfInput" multiple accept="image/*" class="hidden"
                        onchange="handleImg2PdfFiles(this.files)">
                    <i data-lucide="image-plus" class="w-16 h-16 mx-auto mb-4 text-gray-400"></i>
                    <p class="text-lg font-medium mb-2">Arrastra imágenes aquí</p>
                    <p class="text-sm text-gray-400">JPG, PNG, WEBP, GIF</p>
                </div>

                <div id="img2pdfList" class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6 hidden">
                    <!-- Image previews will appear here -->
                </div>

                <div id="img2pdfOptions" class="hidden space-y-6">
                    <div>
                        <label class="block text-sm font-medium mb-2">Orientación de página</label>
                        <div class="grid grid-cols-2 gap-4">
                            <button onclick="setOrientation('portrait')" id="btnPortrait"
                                class="py-3 px-4 rounded-xl border border-purple-500 bg-purple-500/20 text-center transition">
                                <i data-lucide="file-vertical" class="w-6 h-6 mx-auto mb-1"></i>
                                Vertical
                            </button>
                            <button onclick="setOrientation('landscape')" id="btnLandscape"
                                class="py-3 px-4 rounded-xl border border-white/20 hover:bg-white/5 text-center transition">
                                <i data-lucide="file-horizontal" class="w-6 h-6 mx-auto mb-1"></i>
                                Horizontal
                            </button>
                        </div>
                    </div>

                    <div class="flex items-center gap-2">
                        <input type="checkbox" id="fitToPage"
                            class="w-5 h-5 rounded border-white/20 bg-slate-800/50 text-purple-500 focus:ring-purple-500"
                            checked>
                        <label for="fitToPage" class="text-sm">Ajustar imagen a la página</label>
                    </div>

                    <button onclick="convertImagesToPdf()"
                        class="btn-primary w-full py-4 rounded-xl font-semibold text-lg">
                        Crear PDF
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- PDF to Word Tool -->
    <section id="tool-pdf2word" class="tool-section pt-24 pb-12 px-4">
        <div class="max-w-4xl mx-auto">
            <button onclick="showHome()" class="mb-6 flex items-center text-gray-400 hover:text-white transition">
                <i data-lucide="arrow-left" class="w-5 h-5 mr-2"></i>
                Volver al inicio
            </button>

            <div class="glass-card rounded-3xl p-8 md:p-12">
                <div class="text-center mb-8">
                    <div
                        class="w-16 h-16 mx-auto rounded-2xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center mb-4">
                        <i data-lucide="file-type-2" class="w-8 h-8 text-white"></i>
                    </div>
                    <h2 class="text-3xl font-bold mb-2">PDF a Word</h2>
                    <p class="text-gray-400">Extrae texto de PDF a documento Word</p>
                </div>

                <div id="pdf2wordDropZone" class="drop-zone rounded-2xl p-12 text-center cursor-pointer mb-6"
                    onclick="document.getElementById('pdf2wordInput').click()">
                    <input type="file" id="pdf2wordInput" accept=".pdf" class="hidden"
                        onchange="handlePdf2WordFile(this.files[0])">
                    <i data-lucide="file-output" class="w-16 h-16 mx-auto mb-4 text-gray-400"></i>
                    <p class="text-lg font-medium mb-2">Selecciona un archivo PDF</p>
                </div>

                <div id="pdf2wordOptions" class="hidden space-y-6">
                    <div class="bg-yellow-500/10 border border-yellow-500/20 rounded-xl p-4 flex items-start gap-3">
                        <i data-lucide="info" class="w-5 h-5 text-yellow-400 flex-shrink-0 mt-0.5"></i>
                        <p class="text-sm text-gray-300">
                            Esta herramienta extrae el texto del PDF. Para documentos escaneados o con imágenes,
                            el resultado puede variar. Se generará un archivo .docx con el contenido de texto extraído.
                        </p>
                    </div>

                    <button onclick="convertPdfToWord()"
                        class="btn-primary w-full py-4 rounded-xl font-semibold text-lg">
                        Convertir a Word
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Protect PDF Tool -->
    <section id="tool-protect" class="tool-section pt-24 pb-12 px-4">
        <div class="max-w-4xl mx-auto">
            <button onclick="showHome()" class="mb-6 flex items-center text-gray-400 hover:text-white transition">
                <i data-lucide="arrow-left" class="w-5 h-5 mr-2"></i>
                Volver al inicio
            </button>

            <div class="glass-card rounded-3xl p-8 md:p-12">
                <div class="text-center mb-8">
                    <div
                        class="w-16 h-16 mx-auto rounded-2xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center mb-4">
                        <i data-lucide="shield" class="w-8 h-8 text-white"></i>
                    </div>
                    <h2 class="text-3xl font-bold mb-2">Proteger PDF</h2>
                    <p class="text-gray-400">Añade contraseña a tu PDF</p>
                </div>

                <div id="protectDropZone" class="drop-zone rounded-2xl p-12 text-center cursor-pointer mb-6"
                    onclick="document.getElementById('protectInput').click()">
                    <input type="file" id="protectInput" accept=".pdf" class="hidden"
                        onchange="handleProtectFile(this.files[0])">
                    <i data-lucide="lock" class="w-16 h-16 mx-auto mb-4 text-gray-400"></i>
                    <p class="text-lg font-medium mb-2">Selecciona un archivo PDF</p>
                </div>

                <div id="protectOptions" class="hidden space-y-6">
                    <div>
                        <label class="block text-sm font-medium mb-2">Contraseña</label>
                        <input type="password" id="pdfPassword"
                            class="w-full bg-slate-800/50 border border-white/10 rounded-xl px-4 py-3 focus:outline-none focus:border-purple-500 transition"
                            placeholder="Mínimo 6 caracteres">
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Confirmar contraseña</label>
                        <input type="password" id="pdfPasswordConfirm"
                            class="w-full bg-slate-800/50 border border-white/10 rounded-xl px-4 py-3 focus:outline-none focus:border-purple-500 transition"
                            placeholder="Repite la contraseña">
                    </div>

                    <button onclick="protectPDF()" class="btn-primary w-full py-4 rounded-xl font-semibold text-lg">
                        Proteger PDF
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Loading Modal -->
    <div id="loadingModal"
        class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden flex items-center justify-center">
        <div class="bg-slate-800 rounded-2xl p-8 max-w-sm w-full mx-4 text-center">
            <div class="loading-spinner mx-auto mb-4"></div>
            <h3 id="loadingText" class="text-lg font-semibold mb-2">Procesando...</h3>
            <p class="text-sm text-gray-400">Por favor espera un momento</p>
            <div class="mt-4 bg-slate-700 rounded-full h-2 overflow-hidden">
                <div id="progressBar" class="progress-bar h-full w-0"></div>
            </div>
        </div>
    </div>

    <!-- Result Modal -->
    <div id="resultModal"
        class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden flex items-center justify-center">
        <div class="bg-slate-800 rounded-2xl p-8 max-w-md w-full mx-4 text-center">
            <div class="w-16 h-16 mx-auto rounded-full bg-green-500/20 flex items-center justify-center mb-4">
                <i data-lucide="check" class="w-8 h-8 text-green-400"></i>
            </div>
            <h3 class="text-xl font-bold mb-2">¡Proceso completado!</h3>
            <p id="resultText" class="text-gray-400 mb-6">Tu archivo está listo para descargar</p>
            <button onclick="closeResult()" class="btn-primary w-full py-3 rounded-xl font-semibold">
                Descargar archivo
            </button>
        </div>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // Global variables
        let currentFile = null;
        let mergeFiles = [];
        let img2pdfFiles = [];
        let currentOrientation = 'portrait';
        let downloadUrl = null;
        let downloadFilename = '';

        // Navigation functions
        function showHome() {
            document.querySelectorAll('.tool-section').forEach(s => s.classList.remove('active'));
            document.getElementById('home').classList.add('active');
            window.scrollTo(0, 0);
        }

        function showTool(tool) {
            document.querySelectorAll('.tool-section').forEach(s => s.classList.remove('active'));
            document.getElementById(`tool-${tool}`).classList.add('active');
            window.scrollTo(0, 0);
        }

        function toggleMobileMenu() {
            document.getElementById('mobileMenu').classList.toggle('hidden');
        }

        // Drag and drop handlers
        document.querySelectorAll('.drop-zone').forEach(zone => {
            zone.addEventListener('dragover', (e) => {
                e.preventDefault();
                zone.classList.add('dragover');
            });

            zone.addEventListener('dragleave', () => {
                zone.classList.remove('dragover');
            });

            zone.addEventListener('drop', (e) => {
                e.preventDefault();
                zone.classList.remove('dragover');
            });
        });

        // Loading modal functions
        function showLoading(text = 'Procesando...') {
            document.getElementById('loadingText').textContent = text;
            document.getElementById('loadingModal').classList.remove('hidden');
            updateProgress(0);
        }

        function hideLoading() {
            document.getElementById('loadingModal').classList.add('hidden');
        }

        function updateProgress(percent) {
            document.getElementById('progressBar').style.width = percent + '%';
        }

        function showResult(text) {
            document.getElementById('resultText').textContent = text;
            document.getElementById('resultModal').classList.remove('hidden');
        }

        function closeResult() {
            document.getElementById('resultModal').classList.add('hidden');
            if (downloadUrl) {
                const a = document.createElement('a');
                a.href = downloadUrl;
                a.download = downloadFilename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            }
        }

        // QR Code Generator
        let qrCodeObj = null;

        function generateQR() {
            const text = document.getElementById('qrText').value;
            if (!text) {
                alert('Por favor introduce un texto o URL');
                return;
            }

            const size = parseInt(document.getElementById('qrSize').value);
            const color = document.getElementById('qrColor').value;
            const bgColor = document.getElementById('qrBgColor').value;

            document.getElementById('qrResult').classList.remove('hidden');
            document.getElementById('qrcode').innerHTML = '';

            qrCodeObj = new QRCode(document.getElementById('qrcode'), {
                text: text,
                width: size,
                height: size,
                colorDark: color,
                colorLight: bgColor,
                correctLevel: QRCode.CorrectLevel.H
            });
        }

        function downloadQR() {
            const canvas = document.querySelector('#qrcode canvas');
            if (canvas) {
                const link = document.createElement('a');
                link.download = 'qrcode.png';
                link.href = canvas.toDataURL();
                link.click();
            }
        }

        // Merge PDF functions
        function handleMergeFiles(files) {
            const newFiles = Array.from(files).filter(f => f.type === 'application/pdf');
            mergeFiles = [...mergeFiles, ...newFiles];
            updateMergeList();
        }

        function updateMergeList() {
            const list = document.getElementById('mergeFileList');
            if (mergeFiles.length === 0) {
                list.classList.add('hidden');
                document.getElementById('mergeBtn').disabled = true;
                document.getElementById('mergeBtn').classList.add('opacity-50', 'cursor-not-allowed');
                return;
            }

            list.classList.remove('hidden');
            list.innerHTML = mergeFiles.map((file, index) => `
                <div class="file-item flex items-center justify-between bg-slate-800/50 rounded-xl p-4">
                    <div class="flex items-center gap-3">
                        <i data-lucide="file-text" class="w-5 h-5 text-purple-400"></i>
                        <span class="truncate max-w-xs">${file.name}</span>
                        <span class="text-xs text-gray-400">(${(file.size / 1024 / 1024).toFixed(2)} MB)</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <button onclick="moveMergeFile(${index}, -1)" class="p-1 hover:bg-white/10 rounded" ${index === 0 ? 'disabled' : ''}>
                            <i data-lucide="chevron-up" class="w-4 h-4"></i>
                        </button>
                        <button onclick="moveMergeFile(${index}, 1)" class="p-1 hover:bg-white/10 rounded" ${index === mergeFiles.length - 1 ? 'disabled' : ''}>
                            <i data-lucide="chevron-down" class="w-4 h-4"></i>
                        </button>
                        <button onclick="removeMergeFile(${index})" class="p-1 hover:bg-red-500/20 text-red-400 rounded">
                            <i data-lucide="x" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>
            `).join('');

            lucide.createIcons();

            document.getElementById('mergeBtn').disabled = false;
            document.getElementById('mergeBtn').classList.remove('opacity-50', 'cursor-not-allowed');
        }

        function moveMergeFile(index, direction) {
            const newIndex = index + direction;
            if (newIndex >= 0 && newIndex < mergeFiles.length) {
                [mergeFiles[index], mergeFiles[newIndex]] = [mergeFiles[newIndex], mergeFiles[index]];
                updateMergeList();
            }
        }

        function removeMergeFile(index) {
            mergeFiles.splice(index, 1);
            updateMergeList();
        }

        function clearMergeFiles() {
            mergeFiles = [];
            updateMergeList();
            document.getElementById('mergeInput').value = '';
        }

        async function mergePDFs() {
            if (mergeFiles.length < 2) {
                alert('Selecciona al menos 2 archivos PDF para unir');
                return;
            }

            showLoading('Uniendo PDFs...');

            try {
                const mergedPdf = await PDFLib.PDFDocument.create();

                for (let i = 0; i < mergeFiles.length; i++) {
                    const file = mergeFiles[i];
                    const arrayBuffer = await file.arrayBuffer();
                    const pdf = await PDFLib.PDFDocument.load(arrayBuffer);
                    const pages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
                    pages.forEach(page => mergedPdf.addPage(page));
                    updateProgress(((i + 1) / mergeFiles.length) * 100);
                }

                const pdfBytes = await mergedPdf.save();
                const blob = new Blob([pdfBytes], { type: 'application/pdf' });
                downloadUrl = URL.createObjectURL(blob);
                downloadFilename = 'merged.pdf';

                hideLoading();
                showResult(`Se unieron ${mergeFiles.length} archivos PDF correctamente`);
            } catch (error) {
                hideLoading();
                alert('Error al unir PDFs: ' + error.message);
            }
        }

        // Split PDF functions
        let splitPdfDoc = null;

        async function handleSplitFile(file) {
            if (!file) return;

            showLoading('Cargando PDF...');

            try {
                const arrayBuffer = await file.arrayBuffer();
                splitPdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
                const pageCount = splitPdfDoc.getPageCount();

                document.getElementById('totalPages').textContent = pageCount;
                document.getElementById('splitOptions').classList.remove('hidden');
                hideLoading();
            } catch (error) {
                hideLoading();
                alert('Error al cargar PDF: ' + error.message);
            }
        }

        async function splitPDF() {
            if (!splitPdfDoc) return;

            const rangeInput = document.getElementById('pageRange').value.trim();
            const totalPages = splitPdfDoc.getPageCount();

            showLoading('Dividiendo PDF...');

            try {
                if (!rangeInput) {
                    // Split all pages individually
                    const zip = new JSZip();

                    for (let i = 0; i < totalPages; i++) {
                        const newPdf = await PDFLib.PDFDocument.create();
                        const [page] = await newPdf.copyPages(splitPdfDoc, [i]);
                        newPdf.addPage(page);
                        const pdfBytes = await newPdf.save();
                        zip.file(`page_${i + 1}.pdf`, pdfBytes);
                        updateProgress(((i + 1) / totalPages) * 100);
                    }

                    const zipBlob = await zip.generateAsync({ type: 'blob' });
                    downloadUrl = URL.createObjectURL(zipBlob);
                    downloadFilename = 'split_pages.zip';
                    hideLoading();
                    showResult(`Se dividieron ${totalPages} páginas en archivos individuales`);
                } else {
                    // Parse range and split accordingly
                    const pages = parsePageRange(rangeInput, totalPages);
                    const newPdf = await PDFLib.PDFDocument.create();

                    for (let i = 0; i < pages.length; i++) {
                        const [page] = await newPdf.copyPages(splitPdfDoc, [pages[i] - 1]);
                        newPdf.addPage(page);
                        updateProgress(((i + 1) / pages.length) * 100);
                    }

                    const pdfBytes = await newPdf.save();
                    const blob = new Blob([pdfBytes], { type: 'application/pdf' });
                    downloadUrl = URL.createObjectURL(blob);
                    downloadFilename = 'split.pdf';
                    hideLoading();
                    showResult(`Se extrajeron ${pages.length} páginas correctamente`);
                }
            } catch (error) {
                hideLoading();
                alert('Error al dividir PDF: ' + error.message);
            }
        }

        function parsePageRange(range, total) {
            const pages = [];
            const parts = range.split(',');

            for (const part of parts) {
                if (part.includes('-')) {
                    const [start, end] = part.split('-').map(Number);
                    for (let i = start; i <= end && i <= total; i++) {
                        if (!pages.includes(i)) pages.push(i);
                    }
                } else {
                    const page = Number(part);
                    if (page > 0 && page <= total && !pages.includes(page)) {
                        pages.push(page);
                    }
                }
            }

            return pages.sort((a, b) => a - b);
        }

        // Compress PDF functions
        let compressFile = null;

        function handleCompressFile(file) {
            if (!file) return;
            compressFile = file;

            const sizeMB = (file.size / 1024 / 1024).toFixed(2);
            document.getElementById('originalSize').textContent = sizeMB + ' MB';
            document.getElementById('estimatedSize').textContent = (sizeMB * 0.7).toFixed(2) + ' MB';
            document.getElementById('compressOptions').classList.remove('hidden');
        }

        async function compressPDF() {
            if (!compressFile) return;

            showLoading('Comprimiendo PDF...');

            try {
                const arrayBuffer = await compressFile.arrayBuffer();
                const pdf = await PDFLib.PDFDocument.load(arrayBuffer);

                // Remove metadata to save space
                pdf.setTitle('');
                pdf.setAuthor('');
                pdf.setSubject('');
                pdf.setKeywords([]);
                pdf.setProducer('');
                pdf.setCreator('');

                const pdfBytes = await pdf.save({
                    useObjectStreams: true,
                    addDefaultPage: false,
                    preserveExistingEncryption: false
                });

                const blob = new Blob([pdfBytes], { type: 'application/pdf' });
                downloadUrl = URL.createObjectURL(blob);
                downloadFilename = 'compressed.pdf';

                hideLoading();
                showResult('PDF comprimido correctamente');
            } catch (error) {
                hideLoading();
                alert('Error al comprimir PDF: ' + error.message);
            }
        }

        // Office to PDF functions
        let officeFile = null;

        function handleOfficeFile(file) {
            if (!file) return;
            officeFile = file;

            document.getElementById('officeFileName').textContent = file.name;
            document.getElementById('officeFileSize').textContent = (file.size / 1024).toFixed(2) + ' KB';
            document.getElementById('officePreview').classList.remove('hidden');
        }

        async function convertOfficeToPDF() {
            if (!officeFile) return;

            showLoading('Convirtiendo a PDF...');

            try {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();

                // Read file as text (basic conversion for demo)
                const text = await officeFile.text();

                // Add text to PDF (simplified)
                const lines = doc.splitTextToSize(text.substring(0, 5000), 180);
                doc.text(lines, 15, 20);

                const pdfBlob = doc.output('blob');
                downloadUrl = URL.createObjectURL(pdfBlob);
                downloadFilename = officeFile.name.replace(/\.[^/.]+$/, '') + '.pdf';

                hideLoading();
                showResult('Documento convertido a PDF');
            } catch (error) {
                hideLoading();
                alert('Error en conversión: ' + error.message);
            }
        }

        // PDF to Images functions
        let pdf2imgFile = null;

        function handlePdf2ImgFile(file) {
            if (!file) return;
            pdf2imgFile = file;
            document.getElementById('pdf2imgOptions').classList.remove('hidden');
        }

        async function convertPdfToImages() {
            if (!pdf2imgFile) return;

            showLoading('Convirtiendo a imágenes...');

            try {
                const arrayBuffer = await pdf2imgFile.arrayBuffer();
                const pdf = await PDFLib.PDFDocument.load(arrayBuffer);
                const pageCount = pdf.getPageCount();
                const zip = new JSZip();
                const format = document.getElementById('imgFormat').value;

                // Use canvas to render PDF pages
                for (let i = 0; i < pageCount; i++) {
                    const page = pdf.getPage(i);
                    const { width, height } = page.getSize();

                    // Create canvas
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    canvas.width = width * 2;
                    canvas.height = height * 2;

                    // Draw white background
                    ctx.fillStyle = 'white';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);

                    // Note: Actual PDF rendering would require pdf.js library
                    // For this demo, we'll create a placeholder image with page info
                    ctx.fillStyle = '#667eea';
                    ctx.font = 'bold 30px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(`Página ${i + 1}`, canvas.width / 2, canvas.height / 2);

                    const dataUrl = canvas.toDataURL(`image/${format}`);
                    const base64Data = dataUrl.split(',')[1];
                    zip.file(`page_${i + 1}.${format}`, base64Data, { base64: true });

                    updateProgress(((i + 1) / pageCount) * 100);
                }

                const zipBlob = await zip.generateAsync({ type: 'blob' });
                downloadUrl = URL.createObjectURL(zipBlob);
                downloadFilename = 'pdf_images.zip';

                hideLoading();
                showResult(`Se convirtieron ${pageCount} páginas a ${format.toUpperCase()}`);
            } catch (error) {
                hideLoading();
                alert('Error en conversión: ' + error.message);
            }
        }

        // Images to PDF functions
        function handleImg2PdfFiles(files) {
            img2pdfFiles = Array.from(files).filter(f => f.type.startsWith('image/'));
            updateImg2PdfList();
        }

        function updateImg2PdfList() {
            const list = document.getElementById('img2pdfList');
            if (img2pdfFiles.length === 0) {
                list.classList.add('hidden');
                document.getElementById('img2pdfOptions').classList.add('hidden');
                return;
            }

            list.classList.remove('hidden');
            document.getElementById('img2pdfOptions').classList.remove('hidden');

            list.innerHTML = img2pdfFiles.map((file, index) => `
                <div class="relative group aspect-square rounded-xl overflow-hidden bg-slate-800">
                    <img src="${URL.createObjectURL(file)}" class="w-full h-full object-cover" alt="${file.name}">
                    <button onclick="removeImg2Pdf(${index})" class="absolute top-2 right-2 w-6 h-6 bg-red-500 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition">
                        <i data-lucide="x" class="w-4 h-4"></i>
                    </button>
                    <div class="absolute bottom-0 left-0 right-0 bg-black/60 p-2 text-xs truncate">
                        ${file.name}
                    </div>
                </div>
            `).join('');

            lucide.createIcons();
        }

        function removeImg2Pdf(index) {
            img2pdfFiles.splice(index, 1);
            updateImg2PdfList();
        }

        function setOrientation(orientation) {
            currentOrientation = orientation;
            document.getElementById('btnPortrait').classList.toggle('border-purple-500', orientation === 'portrait');
            document.getElementById('btnPortrait').classList.toggle('bg-purple-500/20', orientation === 'portrait');
            document.getElementById('btnLandscape').classList.toggle('border-purple-500', orientation === 'landscape');
            document.getElementById('btnLandscape').classList.toggle('bg-purple-500/20', orientation === 'landscape');
            document.getElementById('btnPortrait').classList.toggle('border-white/20', orientation !== 'portrait');
            document.getElementById('btnLandscape').classList.toggle('border-white/20', orientation !== 'landscape');
        }

        async function convertImagesToPdf() {
            if (img2pdfFiles.length === 0) return;

            showLoading('Creando PDF...');

            try {
                const { jsPDF } = window.jspdf;
                const orientation = currentOrientation;
                const doc = new jsPDF(orientation);
                const fitToPage = document.getElementById('fitToPage').checked;

                for (let i = 0; i < img2pdfFiles.length; i++) {
                    if (i > 0) doc.addPage();

                    const file = img2pdfFiles[i];
                    const imgData = await readFileAsDataURL(file);

                    const img = new Image();
                    await new Promise((resolve) => {
                        img.onload = resolve;
                        img.src = imgData;
                    });

                    const pageWidth = doc.internal.pageSize.getWidth();
                    const pageHeight = doc.internal.pageSize.getHeight();

                    if (fitToPage) {
                        const ratio = Math.min(pageWidth / img.width, pageHeight / img.height);
                        const w = img.width * ratio;
                        const h = img.height * ratio;
                        const x = (pageWidth - w) / 2;
                        const y = (pageHeight - h) / 2;
                        doc.addImage(imgData, 'JPEG', x, y, w, h);
                    } else {
                        doc.addImage(imgData, 'JPEG', 0, 0, pageWidth, pageHeight);
                    }

                    updateProgress(((i + 1) / img2pdfFiles.length) * 100);
                }

                const pdfBlob = doc.output('blob');
                downloadUrl = URL.createObjectURL(pdfBlob);
                downloadFilename = 'images.pdf';

                hideLoading();
                showResult(`Se convirtieron ${img2pdfFiles.length} imágenes a PDF`);
            } catch (error) {
                hideLoading();
                alert('Error al crear PDF: ' + error.message);
            }
        }

        function readFileAsDataURL(file) {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.onload = (e) => resolve(e.target.result);
                reader.readAsDataURL(file);
            });
        }

        // PDF to Word functions
        let pdf2wordFile = null;

        function handlePdf2WordFile(file) {
            if (!file) return;
            pdf2wordFile = file;
            document.getElementById('pdf2wordOptions').classList.remove('hidden');
        }

        async function convertPdfToWord() {
            if (!pdf2wordFile) return;

            showLoading('Extrayendo texto...');

            try {
                const arrayBuffer = await pdf2wordFile.arrayBuffer();
                const pdf = await PDFLib.PDFDocument.load(arrayBuffer);

                // Extract text from all pages
                let fullText = '';
                for (let i = 0; i < pdf.getPageCount(); i++) {
                    fullText += `\n--- Página ${i + 1} ---\n\n`;
                    // Note: PDF-Lib doesn't extract text, this is a placeholder
                    fullText += `[Contenido de la página ${i + 1}]\n`;
                    updateProgress(((i + 1) / pdf.getPageCount()) * 100);
                }

                // Create a simple Word-like HTML file
                const htmlContent = `
                    <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
                    <head><meta charset='utf-8'><title>Documento Word</title></head>
                    <body>${fullText.replace(/\n/g, '<br>')}</body>
                    </html>
                `;

                const blob = new Blob([htmlContent], { type: 'application/msword' });
                downloadUrl = URL.createObjectURL(blob);
                downloadFilename = pdf2wordFile.name.replace('.pdf', '.doc');

                hideLoading();
                showResult('Texto extraído a documento Word');
            } catch (error) {
                hideLoading();
                alert('Error en conversión: ' + error.message);
            }
        }

        // Protect PDF functions
        let protectFile = null;

        function handleProtectFile(file) {
            if (!file) return;
            protectFile = file;
            document.getElementById('protectOptions').classList.remove('hidden');
        }

        async function protectPDF() {
            if (!protectFile) return;

            const password = document.getElementById('pdfPassword').value;
            const confirmPassword = document.getElementById('pdfPasswordConfirm').value;

            if (password.length < 6) {
                alert('La contraseña debe tener al menos 6 caracteres');
                return;
            }

            if (password !== confirmPassword) {
                alert('Las contraseñas no coinciden');
                return;
            }

            showLoading('Aplicando protección...');

            try {
                const arrayBuffer = await protectFile.arrayBuffer();
                const pdf = await PDFLib.PDFDocument.load(arrayBuffer);

                const pdfBytes = await pdf.encrypt({
                    userPassword: password,
                    ownerPassword: password,
                    permissions: {
                        printing: 'highResolution',
                        modifying: false,
                        copying: false,
                        annotating: false,
                        fillingForms: false,
                        contentAccessibility: true,
                        documentAssembly: false
                    }
                });

                const blob = new Blob([pdfBytes], { type: 'application/pdf' });
                downloadUrl = URL.createObjectURL(blob);
                downloadFilename = 'protected.pdf';

                hideLoading();
                showResult('PDF protegido con contraseña correctamente');
            } catch (error) {
                hideLoading();
                alert('Error al proteger PDF: ' + error.message);
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();
        });
    </script>
</body>

</html>
